# 简介与分析

## 模型设计和训练

模型输入维度根据输入格式自动调整，通过线性模型映射到64维向量，然后接两层非线性全连接层，最后输出二维向量进行二分类。

$[0, 999]$ 数据集按照 $0.9:0.1$ 比例划分为训练集和验证集，训练集用于训练模型，验证集用于调整模型参数。训练loss为CrossEntropyLoss，优化器为Adam。

## 输入类型和实验结果

包含四个实验：
+ `raw_num`: 原始数字输入，训练失败，验证集准确率不稳定
+ `bin_num`: 转化为10维的二进制向量输入，训练成功，验证集准确率收敛于1.0
+ `sin_img_1`: 输入为`[sin(x), cos(x)]`，x为0到999的整数，训练失败，验证集准确率不稳定
+ `sin_img_2`: 使用不同周期（指数级缩小）的sin值和cos值作为输入，20维向量，训练成功，验证集准确率收敛于1.0

在性能上`bin_num`和`sin_img_2`相差不大，但是`sin_img_2`的周期需要手动调整，存在一定的风险，因此选择`bin_num`作为最优模型。

## 分析
`raw_num`和`sin_img_1`的训练的根源是loss曲面是高度非凸的，有太多局部极值点，导致训练容易陷入错误的局部最优，而`bin_num`和`sin_img_2`的loss曲面是凸的（或者接近凸的），因此训练更容易收敛。

具体到细节，`bin_num` 对成功是因为模型只需要看二进制输入的最后一位就可以判断奇偶性，使得该拟合问题变得简单。在`sin_img_2`中，因为使用了不同周期的sin和cos函数进行映射，有一定可能取到周期接近2的函数，在这一位置上的数值的功能等价于二进制的最后一位，因此也可以使得该拟合问题变得简单。



